<!DOCTYPE HTML>
<html lang="en" class="dark" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>AavePM - Aave Position Manager</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="book.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "dark";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('dark')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">README</a></li><li class="chapter-item expanded "><a href="src/interfaces/index.html"><strong aria-hidden="true">1.</strong> interfaces</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="src/interfaces/IAavePM.sol/interface.IAavePM.html"><strong aria-hidden="true">1.1.</strong> IAavePM</a></li><li class="chapter-item expanded "><a href="src/interfaces/IERC20Extended.sol/interface.IERC20Extended.html"><strong aria-hidden="true">1.2.</strong> IERC20Extended</a></li><li class="chapter-item expanded "><a href="src/interfaces/IWETH9.sol/interface.IWETH9.html"><strong aria-hidden="true">1.3.</strong> IWETH9</a></li></ol></li><li class="chapter-item expanded "><a href="src/AaveFunctions.sol/contract.AaveFunctions.html"><strong aria-hidden="true">2.</strong> AaveFunctions</a></li><li class="chapter-item expanded "><a href="src/AavePM.sol/contract.AavePM.html"><strong aria-hidden="true">3.</strong> AavePM</a></li><li class="chapter-item expanded "><a href="src/BorrowAndWithdrawUSDC.sol/contract.BorrowAndWithdrawUSDC.html"><strong aria-hidden="true">4.</strong> BorrowAndWithdrawUSDC</a></li><li class="chapter-item expanded "><a href="src/Rebalance.sol/contract.Rebalance.html"><strong aria-hidden="true">5.</strong> Rebalance</a></li><li class="chapter-item expanded "><a href="src/Reinvest.sol/contract.Reinvest.html"><strong aria-hidden="true">6.</strong> Reinvest</a></li><li class="chapter-item expanded "><a href="src/TokenSwaps.sol/contract.TokenSwaps.html"><strong aria-hidden="true">7.</strong> TokenSwaps</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">AavePM - Aave Position Manager</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/EridianAlpha/aave-position-manager" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="aavepm---aave-position-manager"><a class="header" href="#aavepm---aave-position-manager">AavePM - Aave Position Manager</a></h1>
<blockquote>
<hr />
<p>üèóÔ∏è UNDER DEVELOPMENT üèóÔ∏è</p>
<hr />
</blockquote>
<ul>
<li><a href="index.html#1-overview">1. Overview</a>
<ul>
<li><a href="index.html#11-key-functions">1.1. Key Functions</a>
<ul>
<li><a href="index.html#111-owner-functions">1.1.1. Owner Functions</a></li>
<li><a href="index.html#112-manager-functions">1.1.2. Manager Functions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="index.html#2-webapp">2. WebApp</a></li>
<li><a href="index.html#3-installation">3. Installation</a>
<ul>
<li><a href="index.html#31-clone-repository">3.1. Clone repository</a></li>
<li><a href="index.html#32-install-dependencies">3.2. Install Dependencies</a></li>
<li><a href="index.html#33-create-env-file">3.3. Create <code>.env</code> file</a></li>
<li><a href="index.html#34-configure-ethernal-optional">3.4. Configure Ethernal (optional)</a></li>
</ul>
</li>
<li><a href="index.html#4-testing">4. Testing</a>
<ul>
<li><a href="index.html#41-tests">4.1. Tests</a></li>
<li><a href="index.html#42-coverage">4.2. Coverage</a></li>
</ul>
</li>
<li><a href="index.html#5-deployment">5. Deployment</a></li>
<li><a href="index.html#6-upgrades">6. Upgrades</a></li>
<li><a href="index.html#7-interactions">7. Interactions</a>
<ul>
<li><a href="index.html#71-fund-contract-with-eth">7.1. Fund contract with ETH</a></li>
<li><a href="index.html#72-update-health-factor-target">7.2. Update Health Factor Target</a></li>
<li><a href="index.html#73-update-slippage-tolerance">7.3. Update Slippage Tolerance</a></li>
<li><a href="index.html#74-rebalance">7.4. Rebalance</a></li>
<li><a href="index.html#75-get-contract-balance">7.5. Get Contract Balance</a></li>
<li><a href="index.html#76-get-aave-account-data">7.6. Get Aave Account Data</a></li>
</ul>
</li>
<li><a href="index.html#8-build-and-deploy-documentation">8. Build and Deploy Documentation</a></li>
<li><a href="index.html#9-license">9. License</a></li>
</ul>
<h2 id="1-overview"><a class="header" href="#1-overview">1. Overview</a></h2>
<blockquote>
<p>Docs Site: <a href="https://eridianalpha.github.io/aave-position-manager">https://eridianalpha.github.io/aave-position-manager</a></p>
</blockquote>
<p>A smart contract manager for Aave positions.</p>
<ol>
<li>Set a desired Health Factor.</li>
<li>Deposit assets (ETH or wstETH) into the position.</li>
<li>Rebalance the position to maintain the desired Health Factor, either manually or with a bot.</li>
</ol>
<h3 id="11-key-functions"><a class="header" href="#11-key-functions">1.1. Key Functions</a></h3>
<h4 id="111-owner-functions"><a class="header" href="#111-owner-functions">1.1.1. Owner Functions</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Function</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>upgradeToAndCall</td><td><code>OWNER_ROLE</code></td><td>Upgrade the contract</td></tr>
<tr><td>updateContractAddress</td><td><code>OWNER_ROLE</code></td><td>Update the specified contract address</td></tr>
<tr><td>updateTokenAddress</td><td><code>OWNER_ROLE</code></td><td>Update the specified token address</td></tr>
<tr><td>updateUniswapV3Pool</td><td><code>OWNER_ROLE</code></td><td>Update the specified Uniswap V3 pool</td></tr>
</tbody></table>
</div>
<h4 id="112-manager-functions"><a class="header" href="#112-manager-functions">1.1.2. Manager Functions</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Function</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>rebalance</td><td><code>MANAGER_ROLE</code></td><td>Rebalance the Aave position to the desired Health Factor.</td></tr>
<tr><td>borrowAndWithdrawUSDC</td><td><code>MANAGER_ROLE</code></td><td>Borrow USDC from Aave and withdraw to the specified owner.</td></tr>
<tr><td>withdrawWstETH</td><td><code>MANAGER_ROLE</code></td><td>Withdraw all wstETH from the contract to the specified owner.</td></tr>
<tr><td>repayUSDC</td><td><code>MANAGER_ROLE</code></td><td>Repay USDC to Aave using all the USDC in the contract.</td></tr>
<tr><td>withdrawTokens</td><td><code>MANAGER_ROLE</code></td><td>Withdraw all the specified tokens from the contract to the specified owner.</td></tr>
<tr><td>updateHealthFactorTarget</td><td><code>MANAGER_ROLE</code></td><td>Set the desired Health Factor target.</td></tr>
<tr><td>rescueEth</td><td><code>MANAGER_ROLE</code></td><td>Rescue ETH from the contract to the specified owner.</td></tr>
</tbody></table>
</div>
<h2 id="2-webapp"><a class="header" href="#2-webapp">2. WebApp</a></h2>
<p>A WebApp is being developed to allow easy interaction with the smart contract and will be linked here when ready.</p>
<h2 id="3-installation"><a class="header" href="#3-installation">3. Installation</a></h2>
<h3 id="31-clone-repository"><a class="header" href="#31-clone-repository">3.1. Clone repository</a></h3>
<pre><code class="language-bash">git clone https://github.com/EridianAlpha/aave-position-manager.git
</code></pre>
<h3 id="32-install-dependencies"><a class="header" href="#32-install-dependencies">3.2. Install Dependencies</a></h3>
<p>This should happen automatically when first running a command, but the installation can be manually triggered with the following commands:</p>
<pre><code class="language-bash">git submodule init
git submodule update
make install
</code></pre>
<h3 id="33-create-env-file"><a class="header" href="#33-create-env-file">3.3. Create <code>.env</code> file</a></h3>
<p>Use the <code>.env.example</code> file as a template to create a <code>.env</code> file.</p>
<h3 id="34-configure-ethernal-optional"><a class="header" href="#34-configure-ethernal-optional">3.4. Configure Ethernal (optional)</a></h3>
<p>Configure an Ethernal account to interact with the smart contract through a UI (like Etherscan but for a local network).</p>
<p><a href="https://docs.eridianalpha.com/ethereum-dev/useful-tools/ethernal">https://docs.eridianalpha.com/ethereum-dev/useful-tools/ethernal</a></p>
<pre><code class="language-bash">make ethernal
</code></pre>
<h2 id="4-testing"><a class="header" href="#4-testing">4. Testing</a></h2>
<h3 id="41-tests"><a class="header" href="#41-tests">4.1. Tests</a></h3>
<pre><code class="language-bash">make test-fork-mainnet
make test-fork-mainnet-v
make test-fork-mainnet-summary
</code></pre>
<h3 id="42-coverage"><a class="header" href="#42-coverage">4.2. Coverage</a></h3>
<pre><code class="language-bash">make coverage
make coverage-report
</code></pre>
<h2 id="5-deployment"><a class="header" href="#5-deployment">5. Deployment</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Chain</th><th>Command</th></tr></thead><tbody>
<tr><td>Anvil</td><td><code>make deploy-anvil</code></td></tr>
</tbody></table>
</div>
<h2 id="6-upgrades"><a class="header" href="#6-upgrades">6. Upgrades</a></h2>
<p>Upgrade the contract to a new logic implementation while maintaining the same proxy address.</p>
<div class="table-wrapper"><table><thead><tr><th>Chain</th><th>Command</th></tr></thead><tbody>
<tr><td>Anvil</td><td><code>make upgrade-anvil</code></td></tr>
</tbody></table>
</div>
<h2 id="7-interactions"><a class="header" href="#7-interactions">7. Interactions</a></h2>
<p>Interactions are defined in <a href="./script/Interactions.s.sol">Interactions.s.sol</a>.</p>
<h3 id="71-fund-contract-with-eth"><a class="header" href="#71-fund-contract-with-eth">7.1. Fund contract with ETH</a></h3>
<p>Input value in ETH e.g. <code>0.15</code>.</p>
<div class="table-wrapper"><table><thead><tr><th>Chain</th><th>Command</th></tr></thead><tbody>
<tr><td>Anvil</td><td><code>make send-ETH-anvil</code></td></tr>
</tbody></table>
</div>
<h3 id="72-update-health-factor-target"><a class="header" href="#72-update-health-factor-target">7.2. Update Health Factor Target</a></h3>
<p>Input value to 2 decimal places e.g. <code>225</code> for a Health Factor target of <code>2.25</code>.</p>
<div class="table-wrapper"><table><thead><tr><th>Chain</th><th>Command</th></tr></thead><tbody>
<tr><td>Anvil</td><td><code>make update-hft-anvil</code></td></tr>
</tbody></table>
</div>
<h3 id="73-update-slippage-tolerance"><a class="header" href="#73-update-slippage-tolerance">7.3. Update Slippage Tolerance</a></h3>
<p>Input value to 2 decimal places e.g. <code>200</code> for a Slippage Tolerance of <code>0.5%</code>.</p>
<div class="table-wrapper"><table><thead><tr><th>Chain</th><th>Command</th></tr></thead><tbody>
<tr><td>Anvil</td><td><code>make update-st-anvil</code></td></tr>
</tbody></table>
</div>
<h3 id="74-rebalance"><a class="header" href="#74-rebalance">7.4. Rebalance</a></h3>
<p>Rebalances the Aave position to maintain the desired Health Factor target.
TODO: Add threshold details.</p>
<div class="table-wrapper"><table><thead><tr><th>Chain</th><th>Command</th></tr></thead><tbody>
<tr><td>Anvil</td><td><code>make rebalance-anvil</code></td></tr>
</tbody></table>
</div>
<h3 id="75-get-contract-balance"><a class="header" href="#75-get-contract-balance">7.5. Get Contract Balance</a></h3>
<p>Input value as token identifier e.g. <code>USDC</code>.</p>
<div class="table-wrapper"><table><thead><tr><th>Chain</th><th>Command</th></tr></thead><tbody>
<tr><td>Anvil</td><td><code>make getContractBalance-anvil</code></td></tr>
</tbody></table>
</div>
<h3 id="76-get-aave-account-data"><a class="header" href="#76-get-aave-account-data">7.6. Get Aave Account Data</a></h3>
<p>Returns the Aave account data for the contract.</p>
<div class="table-wrapper"><table><thead><tr><th>Chain</th><th>Command</th></tr></thead><tbody>
<tr><td>Anvil</td><td><code>make getAaveAccountData-anvil</code></td></tr>
</tbody></table>
</div>
<h2 id="8-build-and-deploy-documentation"><a class="header" href="#8-build-and-deploy-documentation">8. Build and Deploy Documentation</a></h2>
<p>Instructions on how to build and deploy the documentation book are detailed here: <a href="https://docs.eridianalpha.com/ethereum-dev/foundry-notes/docs-and-github-pages">https://docs.eridianalpha.com/ethereum-dev/foundry-notes/docs-and-github-pages</a></p>
<h2 id="9-license"><a class="header" href="#9-license">9. License</a></h2>
<p><a href="https://choosealicense.com/licenses/mit/">MIT</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents"><a class="header" href="#contents">Contents</a></h1>
<ul>
<li><a href="src/interfaces/IAavePM.sol/interface.IAavePM.html">IAavePM</a></li>
<li><a href="src/interfaces/IERC20Extended.sol/interface.IERC20Extended.html">IERC20Extended</a></li>
<li><a href="src/interfaces/IWETH9.sol/interface.IWETH9.html">IWETH9</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iaavepm"><a class="header" href="#iaavepm">IAavePM</a></h1>
<p><a href="https://github.com/EridianAlpha/aave-position-manager/blob/b932111a5e56b726ed1bad99f7f339ce23f418f5/src/interfaces/IAavePM.sol">Git Source</a></p>
<p>This interface defines the essential structures and functions for the AavePM contract.</p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="initialize"><a class="header" href="#initialize">initialize</a></h3>
<pre><code class="language-solidity">function initialize(
    address owner,
    ContractAddress[] memory contractAddresses,
    TokenAddress[] memory tokenAddresses,
    UniswapV3Pool[] memory uniswapV3Pools,
    uint16 initialHealthFactorTarget,
    uint16 initialSlippageTolerance
) external;
</code></pre>
<h3 id="updatecontractaddress"><a class="header" href="#updatecontractaddress">updateContractAddress</a></h3>
<pre><code class="language-solidity">function updateContractAddress(string memory identifier, address _newContractAddress) external;
</code></pre>
<h3 id="updatetokenaddress"><a class="header" href="#updatetokenaddress">updateTokenAddress</a></h3>
<pre><code class="language-solidity">function updateTokenAddress(string memory identifier, address _newTokenAddress) external;
</code></pre>
<h3 id="updateuniswapv3pool"><a class="header" href="#updateuniswapv3pool">updateUniswapV3Pool</a></h3>
<pre><code class="language-solidity">function updateUniswapV3Pool(string memory _identifier, address _newUniswapV3PoolAddress, uint24 _newUniswapV3PoolFee)
    external;
</code></pre>
<h3 id="updatehealthfactortarget"><a class="header" href="#updatehealthfactortarget">updateHealthFactorTarget</a></h3>
<pre><code class="language-solidity">function updateHealthFactorTarget(uint16 _healthFactorTarget) external;
</code></pre>
<h3 id="updateslippagetolerance"><a class="header" href="#updateslippagetolerance">updateSlippageTolerance</a></h3>
<pre><code class="language-solidity">function updateSlippageTolerance(uint16 _slippageTolerance) external;
</code></pre>
<h3 id="rescueeth"><a class="header" href="#rescueeth">rescueEth</a></h3>
<pre><code class="language-solidity">function rescueEth(address rescueAddress) external;
</code></pre>
<h3 id="rebalance"><a class="header" href="#rebalance">rebalance</a></h3>
<pre><code class="language-solidity">function rebalance() external;
</code></pre>
<h3 id="reinvest"><a class="header" href="#reinvest">reinvest</a></h3>
<pre><code class="language-solidity">function reinvest() external;
</code></pre>
<h3 id="aavesupply"><a class="header" href="#aavesupply">aaveSupply</a></h3>
<pre><code class="language-solidity">function aaveSupply() external;
</code></pre>
<h3 id="aaverepay"><a class="header" href="#aaverepay">aaveRepay</a></h3>
<pre><code class="language-solidity">function aaveRepay() external;
</code></pre>
<h3 id="aavewithdrawwsteth"><a class="header" href="#aavewithdrawwsteth">aaveWithdrawWstETH</a></h3>
<pre><code class="language-solidity">function aaveWithdrawWstETH(uint256 withdrawAmount, address ownerAddress) external;
</code></pre>
<h3 id="borrowandwithdrawusdc"><a class="header" href="#borrowandwithdrawusdc">borrowAndWithdrawUSDC</a></h3>
<pre><code class="language-solidity">function borrowAndWithdrawUSDC(uint256 borrowAmount, address ownerAddress) external;
</code></pre>
<h3 id="getcreator"><a class="header" href="#getcreator">getCreator</a></h3>
<pre><code class="language-solidity">function getCreator() external view returns (address creator);
</code></pre>
<h3 id="getversion"><a class="header" href="#getversion">getVersion</a></h3>
<pre><code class="language-solidity">function getVersion() external pure returns (string memory version);
</code></pre>
<h3 id="getcontractaddress"><a class="header" href="#getcontractaddress">getContractAddress</a></h3>
<pre><code class="language-solidity">function getContractAddress(string memory) external view returns (address contractAddress);
</code></pre>
<h3 id="gettokenaddress"><a class="header" href="#gettokenaddress">getTokenAddress</a></h3>
<pre><code class="language-solidity">function getTokenAddress(string memory) external view returns (address tokenAddress);
</code></pre>
<h3 id="getuniswapv3pool"><a class="header" href="#getuniswapv3pool">getUniswapV3Pool</a></h3>
<pre><code class="language-solidity">function getUniswapV3Pool(string memory)
    external
    view
    returns (address uniswapV3PoolAddress, uint24 uniswapV3PoolFee);
</code></pre>
<h3 id="gethealthfactortarget"><a class="header" href="#gethealthfactortarget">getHealthFactorTarget</a></h3>
<pre><code class="language-solidity">function getHealthFactorTarget() external view returns (uint16 healthFactorTarget);
</code></pre>
<h3 id="gethealthfactortargetminimum"><a class="header" href="#gethealthfactortargetminimum">getHealthFactorTargetMinimum</a></h3>
<pre><code class="language-solidity">function getHealthFactorTargetMinimum() external pure returns (uint16 healthFactorTargetMinimum);
</code></pre>
<h3 id="getslippagetolerance"><a class="header" href="#getslippagetolerance">getSlippageTolerance</a></h3>
<pre><code class="language-solidity">function getSlippageTolerance() external view returns (uint16 slippageTolerance);
</code></pre>
<h3 id="getslippagetolerancemaximum"><a class="header" href="#getslippagetolerancemaximum">getSlippageToleranceMaximum</a></h3>
<pre><code class="language-solidity">function getSlippageToleranceMaximum() external pure returns (uint16 slippageToleranceMaximum);
</code></pre>
<h3 id="getcontractbalance"><a class="header" href="#getcontractbalance">getContractBalance</a></h3>
<pre><code class="language-solidity">function getContractBalance(string memory _identifier) external view returns (uint256 contractBalance);
</code></pre>
<h3 id="getrolemembers"><a class="header" href="#getrolemembers">getRoleMembers</a></h3>
<pre><code class="language-solidity">function getRoleMembers(string memory _roleString) external view returns (address[] memory);
</code></pre>
<h3 id="gettotaldebtinterest"><a class="header" href="#gettotaldebtinterest">getTotalDebtInterest</a></h3>
<pre><code class="language-solidity">function getTotalDebtInterest() external view returns (uint256 totalDebtInterest);
</code></pre>
<h3 id="getwithdrawnusdctotal"><a class="header" href="#getwithdrawnusdctotal">getWithdrawnUSDCTotal</a></h3>
<pre><code class="language-solidity">function getWithdrawnUSDCTotal() external view returns (uint256 withdrawnUSDCTotal);
</code></pre>
<h3 id="getreinvesteddebttotal"><a class="header" href="#getreinvesteddebttotal">getReinvestedDebtTotal</a></h3>
<pre><code class="language-solidity">function getReinvestedDebtTotal() external view returns (uint256 reinvestedDebtTotal);
</code></pre>
<h3 id="gettotalcollateraldelta"><a class="header" href="#gettotalcollateraldelta">getTotalCollateralDelta</a></h3>
<pre><code class="language-solidity">function getTotalCollateralDelta() external view returns (uint256 totalCollateralDelta, bool isPositive);
</code></pre>
<h3 id="getsuppliedcollateraltotal"><a class="header" href="#getsuppliedcollateraltotal">getSuppliedCollateralTotal</a></h3>
<pre><code class="language-solidity">function getSuppliedCollateralTotal() external view returns (uint256 depositedCollateralTotal);
</code></pre>
<h3 id="getreinvestedcollateraltotal"><a class="header" href="#getreinvestedcollateraltotal">getReinvestedCollateralTotal</a></h3>
<pre><code class="language-solidity">function getReinvestedCollateralTotal() external view returns (uint256 reinvestedCollateralTotal);
</code></pre>
<h3 id="getroleadmin"><a class="header" href="#getroleadmin">getRoleAdmin</a></h3>
<pre><code class="language-solidity">function getRoleAdmin(bytes32 role) external view returns (bytes32);
</code></pre>
<h3 id="getrolemember"><a class="header" href="#getrolemember">getRoleMember</a></h3>
<pre><code class="language-solidity">function getRoleMember(bytes32 role, uint256 index) external view returns (address);
</code></pre>
<h3 id="getrolemembercount"><a class="header" href="#getrolemembercount">getRoleMemberCount</a></h3>
<pre><code class="language-solidity">function getRoleMemberCount(bytes32 role) external view returns (uint256);
</code></pre>
<h3 id="grantrole"><a class="header" href="#grantrole">grantRole</a></h3>
<pre><code class="language-solidity">function grantRole(bytes32 role, address account) external;
</code></pre>
<h3 id="hasrole"><a class="header" href="#hasrole">hasRole</a></h3>
<pre><code class="language-solidity">function hasRole(bytes32 role, address account) external view returns (bool);
</code></pre>
<h3 id="renouncerole"><a class="header" href="#renouncerole">renounceRole</a></h3>
<pre><code class="language-solidity">function renounceRole(bytes32 role, address callerConfirmation) external;
</code></pre>
<h3 id="revokerole"><a class="header" href="#revokerole">revokeRole</a></h3>
<pre><code class="language-solidity">function revokeRole(bytes32 role, address account) external;
</code></pre>
<h3 id="supportsinterface"><a class="header" href="#supportsinterface">supportsInterface</a></h3>
<pre><code class="language-solidity">function supportsInterface(bytes4 interfaceId) external view returns (bool);
</code></pre>
<h3 id="upgradetoandcall"><a class="header" href="#upgradetoandcall">upgradeToAndCall</a></h3>
<pre><code class="language-solidity">function upgradeToAndCall(address newImplementation, bytes memory data) external payable;
</code></pre>
<h3 id="executeoperation"><a class="header" href="#executeoperation">executeOperation</a></h3>
<pre><code class="language-solidity">function executeOperation(address asset, uint256 amount, uint256 premium, address initiator, bytes calldata params)
    external
    returns (bool);
</code></pre>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="ethrescued"><a class="header" href="#ethrescued">EthRescued</a></h3>
<pre><code class="language-solidity">event EthRescued(address indexed to, uint256 amount);
</code></pre>
<h3 id="contractaddressupdated"><a class="header" href="#contractaddressupdated">ContractAddressUpdated</a></h3>
<pre><code class="language-solidity">event ContractAddressUpdated(
    string indexed identifier, address indexed previousContractAddress, address indexed newContractAddress
);
</code></pre>
<h3 id="tokenaddressupdated"><a class="header" href="#tokenaddressupdated">TokenAddressUpdated</a></h3>
<pre><code class="language-solidity">event TokenAddressUpdated(
    string indexed identifier, address indexed previousTokenAddress, address indexed newTokenAddress
);
</code></pre>
<h3 id="uniswapv3poolupdated"><a class="header" href="#uniswapv3poolupdated">UniswapV3PoolUpdated</a></h3>
<pre><code class="language-solidity">event UniswapV3PoolUpdated(
    string indexed identifier, address indexed newUniswapV3PoolAddress, uint24 indexed newUniswapV3PoolFee
);
</code></pre>
<h3 id="healthfactortargetupdated"><a class="header" href="#healthfactortargetupdated">HealthFactorTargetUpdated</a></h3>
<pre><code class="language-solidity">event HealthFactorTargetUpdated(uint16 previousHealthFactorTarget, uint16 newHealthFactorTarget);
</code></pre>
<h3 id="slippagetoleranceupdated"><a class="header" href="#slippagetoleranceupdated">SlippageToleranceUpdated</a></h3>
<pre><code class="language-solidity">event SlippageToleranceUpdated(uint16 previousSlippageTolerance, uint16 newSlippageTolerance);
</code></pre>
<h2 id="errors"><a class="header" href="#errors">Errors</a></h2>
<h3 id="aavepm__rescueethfailed"><a class="header" href="#aavepm__rescueethfailed">AavePM__RescueEthFailed</a></h3>
<pre><code class="language-solidity">error AavePM__RescueEthFailed();
</code></pre>
<h3 id="aavepm__addressnotanowner"><a class="header" href="#aavepm__addressnotanowner">AavePM__AddressNotAnOwner</a></h3>
<pre><code class="language-solidity">error AavePM__AddressNotAnOwner();
</code></pre>
<h3 id="aavepm__reinvestnotrequired"><a class="header" href="#aavepm__reinvestnotrequired">AavePM__ReinvestNotRequired</a></h3>
<pre><code class="language-solidity">error AavePM__ReinvestNotRequired();
</code></pre>
<h3 id="aavepm__rebalancenotrequired"><a class="header" href="#aavepm__rebalancenotrequired">AavePM__RebalanceNotRequired</a></h3>
<pre><code class="language-solidity">error AavePM__RebalanceNotRequired();
</code></pre>
<h3 id="aavepm__functiondoesnotexist"><a class="header" href="#aavepm__functiondoesnotexist">AavePM__FunctionDoesNotExist</a></h3>
<pre><code class="language-solidity">error AavePM__FunctionDoesNotExist();
</code></pre>
<h3 id="aavepm__negativeinterestcalc"><a class="header" href="#aavepm__negativeinterestcalc">AavePM__NegativeInterestCalc</a></h3>
<pre><code class="language-solidity">error AavePM__NegativeInterestCalc();
</code></pre>
<h3 id="aavepm__healthfactorunchanged"><a class="header" href="#aavepm__healthfactorunchanged">AavePM__HealthFactorUnchanged</a></h3>
<pre><code class="language-solidity">error AavePM__HealthFactorUnchanged();
</code></pre>
<h3 id="aavepm__healthfactorbelowminimum"><a class="header" href="#aavepm__healthfactorbelowminimum">AavePM__HealthFactorBelowMinimum</a></h3>
<pre><code class="language-solidity">error AavePM__HealthFactorBelowMinimum();
</code></pre>
<h3 id="aavepm__slippagetoleranceunchanged"><a class="header" href="#aavepm__slippagetoleranceunchanged">AavePM__SlippageToleranceUnchanged</a></h3>
<pre><code class="language-solidity">error AavePM__SlippageToleranceUnchanged();
</code></pre>
<h3 id="aavepm__slippagetoleranceabovemaximum"><a class="header" href="#aavepm__slippagetoleranceabovemaximum">AavePM__SlippageToleranceAboveMaximum</a></h3>
<pre><code class="language-solidity">error AavePM__SlippageToleranceAboveMaximum();
</code></pre>
<h3 id="aavefunctions__flashloanmsgsenderunauthorized"><a class="header" href="#aavefunctions__flashloanmsgsenderunauthorized">AaveFunctions__FlashLoanMsgSenderUnauthorized</a></h3>
<pre><code class="language-solidity">error AaveFunctions__FlashLoanMsgSenderUnauthorized();
</code></pre>
<h3 id="aavefunctions__flashloaninitiatorunauthorized"><a class="header" href="#aavefunctions__flashloaninitiatorunauthorized">AaveFunctions__FlashLoanInitiatorUnauthorized</a></h3>
<pre><code class="language-solidity">error AaveFunctions__FlashLoanInitiatorUnauthorized();
</code></pre>
<h3 id="tokenswaps__notenoughtokensforswap"><a class="header" href="#tokenswaps__notenoughtokensforswap">TokenSwaps__NotEnoughTokensForSwap</a></h3>
<pre><code class="language-solidity">error TokenSwaps__NotEnoughTokensForSwap(string tokenInIdentifier);
</code></pre>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="contractaddress"><a class="header" href="#contractaddress">ContractAddress</a></h3>
<pre><code class="language-solidity">struct ContractAddress {
    string identifier;
    address contractAddress;
}
</code></pre>
<h3 id="tokenaddress"><a class="header" href="#tokenaddress">TokenAddress</a></h3>
<pre><code class="language-solidity">struct TokenAddress {
    string identifier;
    address tokenAddress;
}
</code></pre>
<h3 id="uniswapv3pool"><a class="header" href="#uniswapv3pool">UniswapV3Pool</a></h3>
<pre><code class="language-solidity">struct UniswapV3Pool {
    string identifier;
    address poolAddress;
    uint24 fee;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ierc20extended"><a class="header" href="#ierc20extended">IERC20Extended</a></h1>
<p><a href="https://github.com/EridianAlpha/aave-position-manager/blob/b932111a5e56b726ed1bad99f7f339ce23f418f5/src/interfaces/IERC20Extended.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
IERC20</p>
<p>This interface extends the ERC20 interface with the decimals function.</p>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<h3 id="decimals"><a class="header" href="#decimals">decimals</a></h3>
<pre><code class="language-solidity">function decimals() external view returns (uint8);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iweth9"><a class="header" href="#iweth9">IWETH9</a></h1>
<p><a href="https://github.com/EridianAlpha/aave-position-manager/blob/b932111a5e56b726ed1bad99f7f339ce23f418f5/src/interfaces/IWETH9.sol">Git Source</a></p>
<p>This interface enables the wrapping and unwrapping of ETH to WETH.</p>
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<h3 id="deposit"><a class="header" href="#deposit">deposit</a></h3>
<pre><code class="language-solidity">function deposit() external payable;
</code></pre>
<h3 id="withdraw"><a class="header" href="#withdraw">withdraw</a></h3>
<pre><code class="language-solidity">function withdraw(uint256 wad) external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="aavefunctions"><a class="header" href="#aavefunctions">AaveFunctions</a></h1>
<p><a href="https://github.com/EridianAlpha/aave-position-manager/blob/b932111a5e56b726ed1bad99f7f339ce23f418f5/src/AaveFunctions.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/AaveFunctions.sol//src/TokenSwaps.sol/contract.TokenSwaps.html">TokenSwaps</a></p>
<p>// TODO: Add comment</p>
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<h3 id="_aavesupply"><a class="header" href="#_aavesupply">_aaveSupply</a></h3>
<p>Deposit all wstETH into Aave.
TODO: Update comment.</p>
<pre><code class="language-solidity">function _aaveSupply(address aavePoolAddress, address tokenAddress, uint256 tokenBalance) internal;
</code></pre>
<h3 id="_aavewithdrawcollateral"><a class="header" href="#_aavewithdrawcollateral">_aaveWithdrawCollateral</a></h3>
<p>Withdraw wstETH from Aave.
TODO: Update comment.</p>
<pre><code class="language-solidity">function _aaveWithdrawCollateral(address aavePoolAddress, address tokenAddress, uint256 withdrawAmount) internal;
</code></pre>
<h3 id="_aaveborrow"><a class="header" href="#_aaveborrow">_aaveBorrow</a></h3>
<p>Borrow USDC from Aave.
TODO: Update comment.</p>
<pre><code class="language-solidity">function _aaveBorrow(address aavePoolAddress, address tokenAddress, uint256 borrowAmount) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>aavePoolAddress</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>tokenAddress</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>borrowAmount</code></td><td><code>uint256</code></td><td>The amount of USDC to borrow. 8 decimal places to the dollar. e.g. 100000000 = $1.00.</td></tr>
</tbody></table>
</div>
<h3 id="_aaverepaydebt"><a class="header" href="#_aaverepaydebt">_aaveRepayDebt</a></h3>
<p>Repay USDC debt to Aave.
TODO: Update comment.</p>
<pre><code class="language-solidity">function _aaveRepayDebt(address aavePoolAddress, address tokenAddress, uint256 repayAmount) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>aavePoolAddress</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>tokenAddress</code></td><td><code>address</code></td><td></td></tr>
<tr><td><code>repayAmount</code></td><td><code>uint256</code></td><td>The amount of USDC to repay. 8 decimal places to the dollar. e.g. 100000000 = $1.00.</td></tr>
</tbody></table>
</div>
<h3 id="_getcurrentpositionvalues"><a class="header" href="#_getcurrentpositionvalues">_getCurrentPositionValues</a></h3>
<p>// TODO: Add comment.</p>
<p><em>This function is used to avoid code duplication in the Reinvest and Rebalance contracts.</em></p>
<pre><code class="language-solidity">function _getCurrentPositionValues(IAavePM aavePM)
    internal
    view
    returns (
        uint256 initialCollateralBase,
        uint256 totalDebtBase,
        uint256 currentLiquidationThreshold,
        uint256 initialHealthFactorScaled,
        uint16 healthFactorTarget,
        address aavePoolAddress,
        address wstETHAddress,
        address usdcAddress
    );
</code></pre>
<h3 id="_checkhealthfactoraboveminimum"><a class="header" href="#_checkhealthfactoraboveminimum">_checkHealthFactorAboveMinimum</a></h3>
<p>// TODO: Add comment.</p>
<pre><code class="language-solidity">function _checkHealthFactorAboveMinimum(IAavePM aavePM, address aavePoolAddress)
    internal
    view
    returns (
        uint256 totalCollateralBase,
        uint256 totalDebtBase,
        uint256 availableBorrowsBase,
        uint256 currentLiquidationThreshold,
        uint256 ltv,
        uint256 healthFactor
    );
</code></pre>
<h3 id="_gettotaldebtinterest"><a class="header" href="#_gettotaldebtinterest">_getTotalDebtInterest</a></h3>
<p>// TODO: Add comment.</p>
<pre><code class="language-solidity">function _getTotalDebtInterest(uint256 totalDebtBase, uint256 reinvestedDebtTotal, uint256 withdrawnUSDCTotal)
    internal
    pure
    returns (uint256 interest);
</code></pre>
<h3 id="_gettotalcollateraldelta"><a class="header" href="#_gettotalcollateraldelta">_getTotalCollateralDelta</a></h3>
<p>// TODO: Add comment.</p>
<pre><code class="language-solidity">function _getTotalCollateralDelta(
    uint256 totalCollateralBase,
    uint256 reinvestedCollateralTotal,
    uint256 suppliedCollateralTotal
) internal pure returns (uint256 delta, bool isPositive);
</code></pre>
<h3 id="_convertexistingbalancetowstethandsupplytoaave"><a class="header" href="#_convertexistingbalancetowstethandsupplytoaave">_convertExistingBalanceToWstETHAndSupplyToAave</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function _convertExistingBalanceToWstETHAndSupplyToAave(IAavePM aavePM, address aavePoolAddress, address wstETHAddress)
    internal
    returns (uint256 suppliedCollateral);
</code></pre>
<h3 id="_executeoperation"><a class="header" href="#_executeoperation">_executeOperation</a></h3>
<p>Flash loan callback function.</p>
<p><em>This function is called by the Aave pool contract after the flash loan is executed.
It is used to repay the flash loan and execute the operation.
The function is called by the Aave pool contract and is not intended to be called directly.</em></p>
<pre><code class="language-solidity">function _executeOperation(address asset, uint256 amount, uint256 premium, address initiator, bytes calldata)
    internal
    returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>asset</code></td><td><code>address</code></td><td>The address of the asset being flash loaned.</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>The amount of the asset being flash loaned.</td></tr>
<tr><td><code>premium</code></td><td><code>uint256</code></td><td>The fee charged for the flash loan.</td></tr>
<tr><td><code>initiator</code></td><td><code>address</code></td><td>The address of the contract that initiated the flash loan.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes</code></td><td></td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if the operation was successful.</td></tr>
</tbody></table>
</div>
<h3 id="_calculatemaxborrowusdc"><a class="header" href="#_calculatemaxborrowusdc">_calculateMaxBorrowUSDC</a></h3>
<pre><code class="language-solidity">function _calculateMaxBorrowUSDC(
    uint256 totalCollateralBase,
    uint256 totalDebtBase,
    uint256 currentLiquidationThreshold,
    uint16 healthFactorTarget
) internal pure returns (uint256 maxBorrowUSDC);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="aavepm"><a class="header" href="#aavepm">AavePM</a></h1>
<p><a href="https://github.com/EridianAlpha/aave-position-manager/blob/b932111a5e56b726ed1bad99f7f339ce23f418f5/src/AavePM.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/AavePM.sol//src/interfaces/IAavePM.sol/interface.IAavePM.html">IAavePM</a>, <a href="src/AavePM.sol//src/Rebalance.sol/contract.Rebalance.html">Rebalance</a>, <a href="src/AavePM.sol//src/Reinvest.sol/contract.Reinvest.html">Reinvest</a>, <a href="src/AavePM.sol//src/BorrowAndWithdrawUSDC.sol/contract.BorrowAndWithdrawUSDC.html">BorrowAndWithdrawUSDC</a>, Initializable, AccessControlEnumerableUpgradeable, UUPSUpgradeable</p>
<p><strong>Author:</strong>
EridianAlpha</p>
<p>A contract to manage positions on Aave.</p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="s_creator"><a class="header" href="#s_creator">s_creator</a></h3>
<pre><code class="language-solidity">address internal s_creator;
</code></pre>
<h3 id="s_contractaddresses"><a class="header" href="#s_contractaddresses">s_contractAddresses</a></h3>
<pre><code class="language-solidity">mapping(string =&gt; address) internal s_contractAddresses;
</code></pre>
<h3 id="s_tokenaddresses"><a class="header" href="#s_tokenaddresses">s_tokenAddresses</a></h3>
<pre><code class="language-solidity">mapping(string =&gt; address) internal s_tokenAddresses;
</code></pre>
<h3 id="s_uniswapv3pools"><a class="header" href="#s_uniswapv3pools">s_uniswapV3Pools</a></h3>
<pre><code class="language-solidity">mapping(string =&gt; UniswapV3Pool) internal s_uniswapV3Pools;
</code></pre>
<h3 id="s_healthfactortarget"><a class="header" href="#s_healthfactortarget">s_healthFactorTarget</a></h3>
<pre><code class="language-solidity">uint16 internal s_healthFactorTarget;
</code></pre>
<h3 id="s_slippagetolerance"><a class="header" href="#s_slippagetolerance">s_slippageTolerance</a></h3>
<pre><code class="language-solidity">uint16 internal s_slippageTolerance;
</code></pre>
<h3 id="s_withdrawnusdctotal"><a class="header" href="#s_withdrawnusdctotal">s_withdrawnUSDCTotal</a></h3>
<pre><code class="language-solidity">uint256 internal s_withdrawnUSDCTotal = 0;
</code></pre>
<h3 id="s_reinvesteddebttotal"><a class="header" href="#s_reinvesteddebttotal">s_reinvestedDebtTotal</a></h3>
<pre><code class="language-solidity">uint256 internal s_reinvestedDebtTotal = 0;
</code></pre>
<h3 id="s_suppliedcollateraltotal"><a class="header" href="#s_suppliedcollateraltotal">s_suppliedCollateralTotal</a></h3>
<pre><code class="language-solidity">uint256 internal s_suppliedCollateralTotal = 0;
</code></pre>
<h3 id="s_reinvestedcollateraltotal"><a class="header" href="#s_reinvestedcollateraltotal">s_reinvestedCollateralTotal</a></h3>
<pre><code class="language-solidity">uint256 internal s_reinvestedCollateralTotal = 0;
</code></pre>
<h3 id="version"><a class="header" href="#version">VERSION</a></h3>
<p>The version of the contract.</p>
<p><em>Contract is upgradeable so the version is a constant set on each implementation contract.</em></p>
<pre><code class="language-solidity">string internal constant VERSION = &quot;0.0.1&quot;;
</code></pre>
<h3 id="owner_role"><a class="header" href="#owner_role">OWNER_ROLE</a></h3>
<p>The role hashes for the contract.</p>
<p><em>Two independent roles are defined: <code>OWNER_ROLE</code> and <code>MANAGER_ROLE</code>.</em></p>
<pre><code class="language-solidity">bytes32 internal constant OWNER_ROLE = keccak256(&quot;OWNER_ROLE&quot;);
</code></pre>
<h3 id="manager_role"><a class="header" href="#manager_role">MANAGER_ROLE</a></h3>
<pre><code class="language-solidity">bytes32 internal constant MANAGER_ROLE = keccak256(&quot;MANAGER_ROLE&quot;);
</code></pre>
<h3 id="health_factor_target_minimum"><a class="header" href="#health_factor_target_minimum">HEALTH_FACTOR_TARGET_MINIMUM</a></h3>
<p>The minimum Health Factor target.</p>
<p><em>The value is hardcoded in the contract to prevent the position from
being liquidated cause by accidentally setting a low target.
A contract upgrade is required to change this value.</em></p>
<pre><code class="language-solidity">uint16 internal constant HEALTH_FACTOR_TARGET_MINIMUM = 200;
</code></pre>
<h3 id="slippage_tolerance_maximum"><a class="header" href="#slippage_tolerance_maximum">SLIPPAGE_TOLERANCE_MAXIMUM</a></h3>
<p>The maximum Slippage Tolerance.</p>
<p><em>The value is hardcoded in the contract to prevent terrible trades
from occurring due to a high slippage tolerance.
A contract upgrade is required to change this value.</em></p>
<pre><code class="language-solidity">uint16 internal constant SLIPPAGE_TOLERANCE_MAXIMUM = 100;
</code></pre>
<h2 id="functions-4"><a class="header" href="#functions-4">Functions</a></h2>
<h3 id="constructor"><a class="header" href="#constructor">constructor</a></h3>
<p>Constructor implemented but unused.</p>
<p><em>Contract is upgradeable and therefore the constructor is not used.</em></p>
<pre><code class="language-solidity">constructor();
</code></pre>
<h3 id="receive"><a class="header" href="#receive">receive</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">receive() external payable;
</code></pre>
<h3 id="fallback"><a class="header" href="#fallback">fallback</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">fallback() external payable;
</code></pre>
<h3 id="initialize-1"><a class="header" href="#initialize-1">initialize</a></h3>
<p>Initializes contract with the owner and relevant addresses and parameters for operation.</p>
<p><em>This function sets up all necessary state variables for the contract and can only be called once due to the <code>initializer</code> modifier.</em></p>
<pre><code class="language-solidity">function initialize(
    address owner,
    ContractAddress[] memory contractAddresses,
    TokenAddress[] memory tokenAddresses,
    UniswapV3Pool[] memory uniswapV3Pools,
    uint16 initialHealthFactorTarget,
    uint16 initialSlippageTolerance
) public initializer;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>owner</code></td><td><code>address</code></td><td>The address of the owner of the contract.</td></tr>
<tr><td><code>contractAddresses</code></td><td><code>ContractAddress[]</code></td><td>An array of <code>ContractAddress</code> structures containing addresses of related contracts.</td></tr>
<tr><td><code>tokenAddresses</code></td><td><code>TokenAddress[]</code></td><td>An array of <code>TokenAddress</code> structures containing addresses of relevant ERC-20 tokens.</td></tr>
<tr><td><code>uniswapV3Pools</code></td><td><code>UniswapV3Pool[]</code></td><td>An array of <code>UniswapV3Pool</code> structures containing the address and fee of the UniswapV3 pools.</td></tr>
<tr><td><code>initialHealthFactorTarget</code></td><td><code>uint16</code></td><td>The initial target health factor, used to manage risk.</td></tr>
<tr><td><code>initialSlippageTolerance</code></td><td><code>uint16</code></td><td>The initial slippage tolerance for token swaps.</td></tr>
</tbody></table>
</div>
<h3 id="_initializestate"><a class="header" href="#_initializestate">_initializeState</a></h3>
<p>// TODO: Add comment. Just the state setting logic</p>
<pre><code class="language-solidity">function _initializeState(
    address owner,
    ContractAddress[] memory contractAddresses,
    TokenAddress[] memory tokenAddresses,
    UniswapV3Pool[] memory uniswapV3Pools,
    uint16 initialHealthFactorTarget,
    uint16 initialSlippageTolerance
) internal;
</code></pre>
<h3 id="updatecontractaddress-1"><a class="header" href="#updatecontractaddress-1">updateContractAddress</a></h3>
<p>Generic update function to set the contract address for a given identifier.</p>
<p><em>Caller must have <code>OWNER_ROLE</code>.
Emits a <code>ContractAddressUpdated</code> event.</em></p>
<pre><code class="language-solidity">function updateContractAddress(string memory _identifier, address _newContractAddress) external onlyRole(OWNER_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_identifier</code></td><td><code>string</code></td><td>The identifier for the contract address.</td></tr>
<tr><td><code>_newContractAddress</code></td><td><code>address</code></td><td>The new contract address.</td></tr>
</tbody></table>
</div>
<h3 id="updatetokenaddress-1"><a class="header" href="#updatetokenaddress-1">updateTokenAddress</a></h3>
<p>Generic update function to set the token address for a given identifier.</p>
<p><em>Caller must have <code>OWNER_ROLE</code>.
Emits a <code>TokenAddressUpdated</code> event.</em></p>
<pre><code class="language-solidity">function updateTokenAddress(string memory _identifier, address _newTokenAddress) external onlyRole(OWNER_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_identifier</code></td><td><code>string</code></td><td>The identifier for the token address.</td></tr>
<tr><td><code>_newTokenAddress</code></td><td><code>address</code></td><td>The new token address.</td></tr>
</tbody></table>
</div>
<h3 id="updateuniswapv3pool-1"><a class="header" href="#updateuniswapv3pool-1">updateUniswapV3Pool</a></h3>
<p>Update UniSwapV3 pool details.</p>
<p><em>Caller must have <code>OWNER_ROLE</code>.
Emits a <code>UniswapV3PoolUpdated</code> event.</em></p>
<pre><code class="language-solidity">function updateUniswapV3Pool(string memory _identifier, address _newUniswapV3PoolAddress, uint24 _newUniswapV3PoolFee)
    external
    onlyRole(OWNER_ROLE);
</code></pre>
<h3 id="updatehealthfactortarget-1"><a class="header" href="#updatehealthfactortarget-1">updateHealthFactorTarget</a></h3>
<p>Update the Health Factor target.</p>
<p><em>Caller must have <code>MANAGER_ROLE</code>.
Emits a <code>HealthFactorTargetUpdated</code> event.</em></p>
<pre><code class="language-solidity">function updateHealthFactorTarget(uint16 _healthFactorTarget) external onlyRole(MANAGER_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_healthFactorTarget</code></td><td><code>uint16</code></td><td>The new Health Factor target.</td></tr>
</tbody></table>
</div>
<h3 id="updateslippagetolerance-1"><a class="header" href="#updateslippagetolerance-1">updateSlippageTolerance</a></h3>
<p>Update the Slippage Tolerance.</p>
<p><em>Caller must have <code>MANAGER_ROLE</code>.
Emits a <code>SlippageToleranceUpdated</code> event.</em></p>
<pre><code class="language-solidity">function updateSlippageTolerance(uint16 _slippageTolerance) external onlyRole(MANAGER_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_slippageTolerance</code></td><td><code>uint16</code></td><td>The new Slippage Tolerance.</td></tr>
</tbody></table>
</div>
<h3 id="rescueeth-1"><a class="header" href="#rescueeth-1">rescueEth</a></h3>
<p>Rescue all ETH from the contract.</p>
<p><em>This function is intended for emergency use.
In normal operation, the contract shouldn't hold ETH,
as it is used to swap for wstETH.
It is called without an argument to rescue the entire balance.
Caller must have <code>MANAGER_ROLE</code>.
The use of nonReentrant isn't required due to the <code>rescueAddress</code> check for the <code>OWNER_ROLE</code>
and it drains 100% of the ETH balance anyway.
Throws <code>AavePM__RescueEthFailed</code> if the ETH transfer fails.
Emits a <code>RescueEth</code> event.</em></p>
<pre><code class="language-solidity">function rescueEth(address rescueAddress) external onlyRole(MANAGER_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>rescueAddress</code></td><td><code>address</code></td><td>The address to send the rescued ETH to.</td></tr>
</tbody></table>
</div>
<h3 id="rebalance-1"><a class="header" href="#rebalance-1">rebalance</a></h3>
<p>Rebalance the Aave position.</p>
<p><em>Caller must have <code>MANAGER_ROLE</code>.
The function rebalances the Aave position by converting any ETH to WETH, then WETH to wstETH.
It then deposits the wstETH into Aave.
If the health factor is below the target, it repays debt to increase the health factor.</em></p>
<pre><code class="language-solidity">function rebalance() public onlyRole(MANAGER_ROLE);
</code></pre>
<h3 id="reinvest-1"><a class="header" href="#reinvest-1">reinvest</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function reinvest() public onlyRole(MANAGER_ROLE);
</code></pre>
<h3 id="aavesupply-1"><a class="header" href="#aavesupply-1">aaveSupply</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function aaveSupply() public onlyRole(MANAGER_ROLE);
</code></pre>
<h3 id="aaverepay-1"><a class="header" href="#aaverepay-1">aaveRepay</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function aaveRepay() public onlyRole(MANAGER_ROLE);
</code></pre>
<h3 id="aavewithdrawwsteth-1"><a class="header" href="#aavewithdrawwsteth-1">aaveWithdrawWstETH</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function aaveWithdrawWstETH(uint256 _amount, address _owner) public onlyRole(MANAGER_ROLE);
</code></pre>
<h3 id="borrowandwithdrawusdc-1"><a class="header" href="#borrowandwithdrawusdc-1">borrowAndWithdrawUSDC</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function borrowAndWithdrawUSDC(uint256 _amount, address _owner) public onlyRole(MANAGER_ROLE);
</code></pre>
<h3 id="getcreator-1"><a class="header" href="#getcreator-1">getCreator</a></h3>
<p>Getter function to get the i_creator address.</p>
<p><em>Public function to allow anyone to view the contract creator.</em></p>
<pre><code class="language-solidity">function getCreator() public view returns (address creator);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>creator</code></td><td><code>address</code></td><td>The address of the creator.</td></tr>
</tbody></table>
</div>
<h3 id="getversion-1"><a class="header" href="#getversion-1">getVersion</a></h3>
<p>Getter function to get the contract version.</p>
<p><em>Public function to allow anyone to view the contract version.</em></p>
<pre><code class="language-solidity">function getVersion() public pure returns (string memory version);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>version</code></td><td><code>string</code></td><td>The contract version.</td></tr>
</tbody></table>
</div>
<h3 id="getcontractaddress-1"><a class="header" href="#getcontractaddress-1">getContractAddress</a></h3>
<p>Generic getter function to get the contract address for a given identifier.</p>
<p><em>Public function to allow anyone to view the contract address for the given identifier.</em></p>
<pre><code class="language-solidity">function getContractAddress(string memory _identifier) public view returns (address contractAddress);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_identifier</code></td><td><code>string</code></td><td>The identifier for the contract address.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>contractAddress</code></td><td><code>address</code></td><td>The contract address corresponding to the given identifier.</td></tr>
</tbody></table>
</div>
<h3 id="gettokenaddress-1"><a class="header" href="#gettokenaddress-1">getTokenAddress</a></h3>
<p>Generic getter function to get the token address for a given identifier.</p>
<p><em>Public function to allow anyone to view the token address for the given identifier.</em></p>
<pre><code class="language-solidity">function getTokenAddress(string memory _identifier) public view returns (address tokenAddress);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_identifier</code></td><td><code>string</code></td><td>The identifier for the contract address.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokenAddress</code></td><td><code>address</code></td><td>The token address corresponding to the given identifier.</td></tr>
</tbody></table>
</div>
<h3 id="getuniswapv3pool-1"><a class="header" href="#getuniswapv3pool-1">getUniswapV3Pool</a></h3>
<p>Getter function to get the UniswapV3 pool address and fee.</p>
<p><em>Public function to allow anyone to view the UniswapV3 pool address and fee.</em></p>
<pre><code class="language-solidity">function getUniswapV3Pool(string memory _identifier)
    public
    view
    returns (address uniswapV3PoolAddress, uint24 uniswapV3PoolFee);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_identifier</code></td><td><code>string</code></td><td>The identifier for the UniswapV3 pool.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>uniswapV3PoolAddress</code></td><td><code>address</code></td><td>The UniswapV3 pool address.</td></tr>
<tr><td><code>uniswapV3PoolFee</code></td><td><code>uint24</code></td><td>The UniswapV3 pool fee.</td></tr>
</tbody></table>
</div>
<h3 id="gethealthfactortarget-1"><a class="header" href="#gethealthfactortarget-1">getHealthFactorTarget</a></h3>
<p>Getter function to get the Health Factor target.</p>
<p><em>Public function to allow anyone to view the Health Factor target value.</em></p>
<pre><code class="language-solidity">function getHealthFactorTarget() public view returns (uint16 healthFactorTarget);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>healthFactorTarget</code></td><td><code>uint16</code></td><td>The Health Factor target.</td></tr>
</tbody></table>
</div>
<h3 id="gethealthfactortargetminimum-1"><a class="header" href="#gethealthfactortargetminimum-1">getHealthFactorTargetMinimum</a></h3>
<p>Getter function to get the Health Factor Target minimum.</p>
<p><em>Public function to allow anyone to view the Health Factor Target minimum value.</em></p>
<pre><code class="language-solidity">function getHealthFactorTargetMinimum() public pure returns (uint16 healthFactorTargetMinimum);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>healthFactorTargetMinimum</code></td><td><code>uint16</code></td><td>The Health Factor Target minimum value.</td></tr>
</tbody></table>
</div>
<h3 id="getslippagetolerance-1"><a class="header" href="#getslippagetolerance-1">getSlippageTolerance</a></h3>
<p>Getter function to get the Slippage Tolerance.</p>
<p><em>Public function to allow anyone to view the Slippage Tolerance value.</em></p>
<pre><code class="language-solidity">function getSlippageTolerance() public view returns (uint16 slippageTolerance);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>slippageTolerance</code></td><td><code>uint16</code></td><td>The Slippage Tolerance value.</td></tr>
</tbody></table>
</div>
<h3 id="getslippagetolerancemaximum-1"><a class="header" href="#getslippagetolerancemaximum-1">getSlippageToleranceMaximum</a></h3>
<p>Getter function to get the Slippage Tolerance maximum.</p>
<p><em>Public function to allow anyone to view the Slippage Tolerance maximum value.</em></p>
<pre><code class="language-solidity">function getSlippageToleranceMaximum() public pure returns (uint16 slippageToleranceMaximum);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>slippageToleranceMaximum</code></td><td><code>uint16</code></td><td>The Slippage Tolerance maximum value.</td></tr>
</tbody></table>
</div>
<h3 id="getcontractbalance-1"><a class="header" href="#getcontractbalance-1">getContractBalance</a></h3>
<p>Getter function to get the balance of the provided identifier.</p>
<p><em>Public function to allow anyone to view the balance of the provided identifier.</em></p>
<pre><code class="language-solidity">function getContractBalance(string memory _identifier) public view returns (uint256 contractBalance);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_identifier</code></td><td><code>string</code></td><td>The identifier for the token address.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>contractBalance</code></td><td><code>uint256</code></td><td>The balance of the specified token identifier.</td></tr>
</tbody></table>
</div>
<h3 id="getrolemembers-1"><a class="header" href="#getrolemembers-1">getRoleMembers</a></h3>
<p>Getter function to get all the members of a role.</p>
<p><em>Public function to allow anyone to view the members of a role.</em></p>
<pre><code class="language-solidity">function getRoleMembers(string memory _roleString) public view returns (address[] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_roleString</code></td><td><code>string</code></td><td>The identifier for the role.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>address[]</code></td><td>members The array of addresses that are members of the role.</td></tr>
</tbody></table>
</div>
<h3 id="gettotaldebtinterest-1"><a class="header" href="#gettotaldebtinterest-1">getTotalDebtInterest</a></h3>
<p>Getter function to get the total debt interest.</p>
<p><em>Public function to allow anyone to view the total debt interest.</em></p>
<pre><code class="language-solidity">function getTotalDebtInterest() public view returns (uint256 totalDebtInterest);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>totalDebtInterest</code></td><td><code>uint256</code></td><td>The total debt interest.</td></tr>
</tbody></table>
</div>
<h3 id="getwithdrawnusdctotal-1"><a class="header" href="#getwithdrawnusdctotal-1">getWithdrawnUSDCTotal</a></h3>
<p>Getter function to get the total amount of USDC withdrawn.</p>
<p><em>Public function to allow anyone to view the total amount of USDC withdrawn.</em></p>
<pre><code class="language-solidity">function getWithdrawnUSDCTotal() public view returns (uint256 withdrawnUSDCTotal);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>withdrawnUSDCTotal</code></td><td><code>uint256</code></td><td>The total amount of USDC withdrawn.</td></tr>
</tbody></table>
</div>
<h3 id="getreinvesteddebttotal-1"><a class="header" href="#getreinvesteddebttotal-1">getReinvestedDebtTotal</a></h3>
<p>Getter function to get the total amount of reinvested debt.</p>
<p><em>Public function to allow anyone to view the total amount of reinvested debt.</em></p>
<pre><code class="language-solidity">function getReinvestedDebtTotal() public view returns (uint256 reinvestedDebtTotal);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>reinvestedDebtTotal</code></td><td><code>uint256</code></td><td>The total amount of reinvested debt.</td></tr>
</tbody></table>
</div>
<h3 id="gettotalcollateraldelta-1"><a class="header" href="#gettotalcollateraldelta-1">getTotalCollateralDelta</a></h3>
<p>Getter function to get the total collateral delta.</p>
<p><em>Public function to allow anyone to view the total collateral delta.</em></p>
<pre><code class="language-solidity">function getTotalCollateralDelta() public view returns (uint256 totalCollateralDelta, bool isPositive);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>totalCollateralDelta</code></td><td><code>uint256</code></td><td>The total collateral delta.</td></tr>
<tr><td><code>isPositive</code></td><td><code>bool</code></td><td>A boolean indicating if the total collateral delta is positive.</td></tr>
</tbody></table>
</div>
<h3 id="getsuppliedcollateraltotal-1"><a class="header" href="#getsuppliedcollateraltotal-1">getSuppliedCollateralTotal</a></h3>
<p>Getter function to get the total amount of supplied collateral.</p>
<p><em>Public function to allow anyone to view the total amount of supplied collateral.</em></p>
<pre><code class="language-solidity">function getSuppliedCollateralTotal() public view returns (uint256 suppliedCollateralTotal);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>suppliedCollateralTotal</code></td><td><code>uint256</code></td><td>The total amount of supplied collateral.</td></tr>
</tbody></table>
</div>
<h3 id="getreinvestedcollateraltotal-1"><a class="header" href="#getreinvestedcollateraltotal-1">getReinvestedCollateralTotal</a></h3>
<p>Getter function to get the total amount of reinvested collateral.</p>
<p><em>Public function to allow anyone to view the total amount of reinvested collateral.</em></p>
<pre><code class="language-solidity">function getReinvestedCollateralTotal() public view returns (uint256 reinvestedCollateralTotal);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>reinvestedCollateralTotal</code></td><td><code>uint256</code></td><td>The total amount of reinvested collateral.</td></tr>
</tbody></table>
</div>
<h3 id="getrolemember-1"><a class="header" href="#getrolemember-1">getRoleMember</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function getRoleMember(bytes32 role, uint256 index)
    public
    view
    override(IAavePM, AccessControlEnumerableUpgradeable)
    returns (address);
</code></pre>
<h3 id="getrolemembercount-1"><a class="header" href="#getrolemembercount-1">getRoleMemberCount</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function getRoleMemberCount(bytes32 role)
    public
    view
    override(IAavePM, AccessControlEnumerableUpgradeable)
    returns (uint256);
</code></pre>
<h3 id="getroleadmin-1"><a class="header" href="#getroleadmin-1">getRoleAdmin</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function getRoleAdmin(bytes32 role)
    public
    view
    override(IAavePM, IAccessControl, AccessControlUpgradeable)
    returns (bytes32);
</code></pre>
<h3 id="grantrole-1"><a class="header" href="#grantrole-1">grantRole</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function grantRole(bytes32 role, address account) public override(IAavePM, IAccessControl, AccessControlUpgradeable);
</code></pre>
<h3 id="hasrole-1"><a class="header" href="#hasrole-1">hasRole</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function hasRole(bytes32 role, address account)
    public
    view
    override(IAavePM, IAccessControl, AccessControlUpgradeable)
    returns (bool);
</code></pre>
<h3 id="renouncerole-1"><a class="header" href="#renouncerole-1">renounceRole</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function renounceRole(bytes32 role, address callerConfirmation)
    public
    override(IAavePM, IAccessControl, AccessControlUpgradeable);
</code></pre>
<h3 id="revokerole-1"><a class="header" href="#revokerole-1">revokeRole</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function revokeRole(bytes32 role, address account) public override(IAavePM, IAccessControl, AccessControlUpgradeable);
</code></pre>
<h3 id="supportsinterface-1"><a class="header" href="#supportsinterface-1">supportsInterface</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function supportsInterface(bytes4 interfaceId)
    public
    view
    override(IAavePM, AccessControlEnumerableUpgradeable)
    returns (bool);
</code></pre>
<h3 id="_authorizeupgrade"><a class="header" href="#_authorizeupgrade">_authorizeUpgrade</a></h3>
<p>Internal function to authorize an upgrade.</p>
<p><em>Caller must have <code>OWNER_ROLE</code>.</em></p>
<pre><code class="language-solidity">function _authorizeUpgrade(address _newImplementation) internal override onlyRole(OWNER_ROLE);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_newImplementation</code></td><td><code>address</code></td><td>Address of the new contract implementation.</td></tr>
</tbody></table>
</div>
<h3 id="upgradetoandcall-1"><a class="header" href="#upgradetoandcall-1">upgradeToAndCall</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function upgradeToAndCall(address newImplementation, bytes memory data)
    public
    payable
    override(IAavePM, UUPSUpgradeable);
</code></pre>
<h3 id="executeoperation-1"><a class="header" href="#executeoperation-1">executeOperation</a></h3>
<p>Flash loan callback function.</p>
<p><em>This function is called by the Aave pool contract after the flash loan is executed.
It is used to repay the flash loan and execute the operation.
The function is called by the Aave pool contract and is not intended to be called directly.</em></p>
<pre><code class="language-solidity">function executeOperation(address asset, uint256 amount, uint256 premium, address initiator, bytes calldata params)
    external
    returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>asset</code></td><td><code>address</code></td><td>The address of the asset being flash loaned.</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>The amount of the asset being flash loaned.</td></tr>
<tr><td><code>premium</code></td><td><code>uint256</code></td><td>The fee charged for the flash loan.</td></tr>
<tr><td><code>initiator</code></td><td><code>address</code></td><td>The address of the contract that initiated the flash loan.</td></tr>
<tr><td><code>params</code></td><td><code>bytes</code></td><td>The parameters for the flash loan operation.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if the operation was successful.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="borrowandwithdrawusdc-2"><a class="header" href="#borrowandwithdrawusdc-2">BorrowAndWithdrawUSDC</a></h1>
<p><a href="https://github.com/EridianAlpha/aave-position-manager/blob/b932111a5e56b726ed1bad99f7f339ce23f418f5/src/BorrowAndWithdrawUSDC.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/BorrowAndWithdrawUSDC.sol//src/TokenSwaps.sol/contract.TokenSwaps.html">TokenSwaps</a>, <a href="src/BorrowAndWithdrawUSDC.sol//src/AaveFunctions.sol/contract.AaveFunctions.html">AaveFunctions</a></p>
<p>// TODO: Add comment</p>
<h2 id="functions-5"><a class="header" href="#functions-5">Functions</a></h2>
<h3 id="_borrowandwithdrawusdc"><a class="header" href="#_borrowandwithdrawusdc">_borrowAndWithdrawUSDC</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function _borrowAndWithdrawUSDC(uint256 borrowAmountUSDC, address _owner) internal;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rebalance-2"><a class="header" href="#rebalance-2">Rebalance</a></h1>
<p><a href="https://github.com/EridianAlpha/aave-position-manager/blob/b932111a5e56b726ed1bad99f7f339ce23f418f5/src/Rebalance.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/Rebalance.sol//src/TokenSwaps.sol/contract.TokenSwaps.html">TokenSwaps</a>, <a href="src/Rebalance.sol//src/AaveFunctions.sol/contract.AaveFunctions.html">AaveFunctions</a></p>
<p>// TODO: Add comment</p>
<h2 id="functions-6"><a class="header" href="#functions-6">Functions</a></h2>
<h3 id="_rebalance"><a class="header" href="#_rebalance">_rebalance</a></h3>
<p>Rebalance the Aave position.</p>
<p><em>Caller must have <code>MANAGER_ROLE</code>.
The function rebalances the Aave position.
If the health factor is below the target, it repays debt to increase the health factor.</em></p>
<pre><code class="language-solidity">function _rebalance() internal;
</code></pre>
<h3 id="_repaydebt"><a class="header" href="#_repaydebt">_repayDebt</a></h3>
<pre><code class="language-solidity">function _repayDebt(
    uint256 totalDebtBase,
    address aavePoolAddress,
    address usdcAddress,
    uint256 totalCollateralBase,
    uint256 currentLiquidationThreshold,
    uint16 healthFactorTarget
) private;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reinvest-2"><a class="header" href="#reinvest-2">Reinvest</a></h1>
<p><a href="https://github.com/EridianAlpha/aave-position-manager/blob/b932111a5e56b726ed1bad99f7f339ce23f418f5/src/Reinvest.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="src/Reinvest.sol//src/TokenSwaps.sol/contract.TokenSwaps.html">TokenSwaps</a>, <a href="src/Reinvest.sol//src/AaveFunctions.sol/contract.AaveFunctions.html">AaveFunctions</a></p>
<p>// TODO: Add comment</p>
<h2 id="functions-7"><a class="header" href="#functions-7">Functions</a></h2>
<h3 id="_reinvest"><a class="header" href="#_reinvest">_reinvest</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function _reinvest() internal returns (uint256 reinvestedDebt, uint256 reinvestedCollateral);
</code></pre>
<h3 id="_reinvestaction"><a class="header" href="#_reinvestaction">_reinvestAction</a></h3>
<pre><code class="language-solidity">function _reinvestAction(
    IAavePM aavePM,
    uint256 totalDebtBase,
    address aavePoolAddress,
    address usdcAddress,
    address wstETHAddress,
    uint256 initialCollateralBase,
    uint256 currentLiquidationThreshold,
    uint16 healthFactorTarget
) private returns (uint256 borrowAmountUSDC);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tokenswaps"><a class="header" href="#tokenswaps">TokenSwaps</a></h1>
<p><a href="https://github.com/EridianAlpha/aave-position-manager/blob/b932111a5e56b726ed1bad99f7f339ce23f418f5/src/TokenSwaps.sol">Git Source</a></p>
<p>// TODO: Add comment</p>
<h2 id="functions-8"><a class="header" href="#functions-8">Functions</a></h2>
<h3 id="_swaptokens"><a class="header" href="#_swaptokens">_swapTokens</a></h3>
<p>Swaps the contract's entire specified token balance using a UniswapV3 pool.</p>
<p><em>Calculates the minimum amount that should be received based on the current pool's price ratio and a predefined slippage tolerance.
Reverts if there are no tokens in the contract or if the transaction doesn't meet the <code>amountOutMinimum</code> criteria due to price movements.</em></p>
<pre><code class="language-solidity">function _swapTokens(
    string memory _uniswapV3PoolIdentifier,
    string memory _tokenInIdentifier,
    string memory _tokenOutIdentifier
) internal returns (string memory tokenOutIdentifier, uint256 amountOut);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_uniswapV3PoolIdentifier</code></td><td><code>string</code></td><td>The identifier of the UniswapV3 pool to use for the swap.</td></tr>
<tr><td><code>_tokenInIdentifier</code></td><td><code>string</code></td><td>The identifier of the token to swap.</td></tr>
<tr><td><code>_tokenOutIdentifier</code></td><td><code>string</code></td><td>The identifier of the token to receive from the swap.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tokenOutIdentifier</code></td><td><code>string</code></td><td>The identifier of the token received from the swap.</td></tr>
<tr><td><code>amountOut</code></td><td><code>uint256</code></td><td>The amount tokens received from the swap.</td></tr>
</tbody></table>
</div>
<h3 id="approveandexecuteswap"><a class="header" href="#approveandexecuteswap">approveAndExecuteSwap</a></h3>
<pre><code class="language-solidity">function approveAndExecuteSwap(IAavePM aavePM, ISwapRouter.ExactInputSingleParams memory params, uint256 currentBalance)
    private
    returns (uint256 amountOut);
</code></pre>
<h3 id="_wrapethtoweth"><a class="header" href="#_wrapethtoweth">_wrapETHToWETH</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function _wrapETHToWETH() internal;
</code></pre>
<h3 id="uniswapv3calculateminout"><a class="header" href="#uniswapv3calculateminout">uniswapV3CalculateMinOut</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function uniswapV3CalculateMinOut(
    IAavePM aavePM,
    uint256 _currentBalance,
    address _uniswapV3PoolAddress,
    address tokenInAddress,
    address tokenOutAddress
) private view returns (uint256 minOut);
</code></pre>
<h3 id="_isidentifiereth"><a class="header" href="#_isidentifiereth">_isIdentifierETH</a></h3>
<p>// TODO: Add comment</p>
<pre><code class="language-solidity">function _isIdentifierETH(string memory identifier) private pure returns (bool);
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="solidity.min.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
